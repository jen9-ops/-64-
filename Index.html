<!DOCTYPE html><html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–í—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π –ø—Ä–æ—Ü–µ—Å–æ—Ä</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(to bottom, #ffe8a0, #fff3cc);
      font-family: 'Comic Sans MS', cursive, sans-serif;
      text-align: center;
      color: #333;
    }
    h1 {
      margin-top: 20px;
      font-size: 2em;
      color: #f9a825;
    }
    .chip {
      background: rgba(255,255,255,0.8);
      border: 2px solid #fbc02d;
      border-radius: 12px;
      padding: 10px;
      width: 90%;
      max-width: 800px;
      margin: 10px auto;
    }
    .chip h3 {
      margin: 5px 0 10px;
    }
    .state {
      font-size: 1.1em;
      font-weight: bold;
      color: #2e7d32;
      word-break: break-word;
    }
    .mem-cell {
      display: inline-block;
      margin: 1px;
      padding: 4px;
      min-width: 36px;
      background: #fff;
      border: 1px solid #bbb;
      border-radius: 5px;
      font-family: monospace;
    }
    .mem-cell.active {
      background: #fdd835;
      border-color: #f9a825;
    }
    select, input[type="text"], input[type="number"], textarea {
      padding: 5px;
      font-size: 1em;
      width: 90%;
      margin: 5px 0;
    }
    button {
      margin: 5px;
      padding: 10px 15px;
      font-size: 1em;
      background-color: #fdd835;
      color: #000;
      border: 2px solid #fbc02d;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #fbc02d;
    }
    .console {
      background: #111;
      color: #0f0;
      font-family: monospace;
      padding: 10px;
      margin: 20px auto;
      width: 90%;
      max-width: 800px;
      height: 180px;
      overflow-y: auto;
      border: 2px solid #444;
      border-radius: 10px;
      text-align: left;
    }
    .grid-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
      gap: 5px;
      justify-items: center;
    }
  </style>
</head>
<body><h1>üß† –í—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π –ø—Ä–æ—Ü–µ—Å–æ—Ä</h1>
<p>–°–∏–º—É–ª—è—Ü—ñ—è –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞ –∑ 64 –±–∞–π—Ç–∞–º–∏ –ø–∞–º º—è—Ç—ñ, —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏ —Ç–∞ –≤–ª–∞—Å–Ω–æ—é –º–æ–≤–æ—é</p><div class="chip" id="clock">
  <h3>‚è±Ô∏è –¢–∞–∫—Ç–æ–≤–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä</h3>
  <div class="state" id="clockState">–û—á—ñ–∫—É—î...</div>
</div><div class="chip">
  <h3>–†–µ–≥—ñ—Å—Ç—Ä</h3>
  <div class="state" id="register">0</div>
</div><div class="chip">
  <h3>–ü–∞–º º—è—Ç—å (64 –±–∞–π—Ç–∏)</h3>
  <div class="state" id="memoryDisplay"></div>
</div><div class="chip">
  <h3>–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è</h3>
  <input type="text" id="instruction" placeholder="LOAD 2 / ADD 1 / STORE 0">
  <div class="state" id="instStatus">–û—á—ñ–∫—É—î...</div>
</div><div>
  <button id="runButton">‚ñ∂ –í–∏–∫–æ–Ω–∞—Ç–∏ –≤—Ä—É—á–Ω—É</button>
  <button id="autoRun">‚ñ∂ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ</button>
  <button id="stopRun">‚èπ –ó—É–ø–∏–Ω–∏—Ç–∏</button>
  <button onclick="printText()">üì§ –í–∏–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç</button>
</div><div class="chip">
  <h3>üì± –ö–µ—Ä—É–≤–∞–Ω–Ω—è —Ä–µ–≥—ñ—Å—Ç—Ä–æ–º</h3>
  <input type="number" id="regInput" placeholder="–ö–æ–¥ —Å–∏–º–≤–æ–ª—É (–Ω–∞–ø—Ä. 1087)">
  <button onclick="setRegister()">üî¢ –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –≤ —Ä–µ–≥—ñ—Å—Ç—Ä</button>
  <div class="grid-buttons" id="storeButtons"></div>
</div><div class="chip">
  <h3>üßæ –ü—Ä–æ–≥—Ä–∞–º–∞ (–≤–ª–∞—Å–Ω–∞ –º–æ–≤–∞)</h3>
  <textarea id="program" rows="6" placeholder="SET 0 = 1087\nSET 1 = 1088\nADD 0 1 -> 2\nIF MEM[2] == 2175 THEN PRINT '–ø–æ–∫–∞'"></textarea>
  <button onclick="runProgram()">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É</button>
</div><div class="console" id="console"></div><script>
let memory = new Array(64).fill(0);
let register = 0;
let clockOn = false;
let clockInterval = null;
let lastAccess = -1;
const consoleEl = document.getElementById('console');
const memoryDisplay = document.getElementById('memoryDisplay');
const storeButtonsContainer = document.getElementById('storeButtons');

function logToConsole(message) {
  const time = new Date().toLocaleTimeString();
  consoleEl.innerHTML += `[${time}] ${message}<br>`;
  consoleEl.scrollTop = consoleEl.scrollHeight;
}

function update() {
  memoryDisplay.innerHTML = '';
  memory.forEach((v, i) => {
    const cell = document.createElement('span');
    cell.className = 'mem-cell' + (i === lastAccess ? ' active' : '');
    cell.innerText = `${i}:${v}`;
    memoryDisplay.appendChild(cell);
  });
  document.getElementById('register').innerText = register;
}

function executeInstruction(instrText) {
  let instr = (instrText || document.getElementById('instruction').value).trim().toUpperCase();
  let parts = instr.split(" ");
  let cmd = parts[0];
  let arg = parseInt(parts[1]);
  let status = '‚úîÔ∏è OK';

  try {
    switch (cmd) {
      case 'LOAD':
        if (arg >= 0 && arg < memory.length) {
          register = memory[arg];
          lastAccess = arg;
          logToConsole(`LOAD ${arg} ‚Üí ${register}`);
        } else throw '–ù–µ–≤—ñ—Ä–Ω–∞ –∞–¥—Ä–µ—Å–∞ LOAD';
        break;
      case 'ADD':
        if (arg >= 0 && arg < memory.length) {
          register += memory[arg];
          lastAccess = arg;
          logToConsole(`ADD ${arg} ‚Üí ${register}`);
        } else throw '–ù–µ–≤—ñ—Ä–Ω–∞ –∞–¥—Ä–µ—Å–∞ ADD';
        break;
      case 'STORE':
        if (arg >= 0 && arg < memory.length) {
          memory[arg] = register;
          lastAccess = arg;
          logToConsole(`STORE ${arg} ‚Üê ${register}`);
        } else throw '–ù–µ–≤—ñ—Ä–Ω–∞ –∞–¥—Ä–µ—Å–∞ STORE';
        break;
      default:
        throw '–ù–µ–≤—ñ–¥–æ–º–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è';
    }
  } catch (err) {
    status = '‚ùå ' + err;
    logToConsole(status);
  }

  document.getElementById('instStatus').innerText = status;
  update();
}

function printText() {
  const text = memory.map(v => v > 0 ? String.fromCharCode(v) : '').join('');
  logToConsole('üì§ –í–∏–≤—ñ–¥: ' + text);
}

function setRegister() {
  const val = parseInt(document.getElementById("regInput").value);
  if (!isNaN(val)) {
    register = val;
    logToConsole('üî¢ –†–µ–≥—ñ—Å—Ç—Ä = ' + val);
    update();
  } else {
    logToConsole('‚ùå –ù–µ–≤—ñ—Ä–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è —Ä–µ–≥—ñ—Å—Ç—Ä–∞');
  }
}

function storeTo(addr) {
  if (addr >= 0 && addr < memory.length) {
    memory[addr] = register;
    lastAccess = addr;
    logToConsole(`üíæ STORE ${addr} ‚Üê ${register}`);
    update();
  }
}

function createStoreButtons() {
  for (let i = 0; i < 64; i++) {
    const btn = document.createElement('button');
    btn.textContent = `STORE ${i}`;
    btn.onclick = () => storeTo(i);
    storeButtonsContainer.appendChild(btn);
  }
}

function runProgram() {
  const lines = document.getElementById('program').value.trim().split(/\n+/);
  lines.forEach(line => {
    const cmd = line.trim();
    if (cmd.startsWith('SET')) {
      const [, addr, val] = cmd.match(/SET (\d+) = (\d+)/);
      memory[+addr] = +val;
      logToConsole(`SET ${addr} = ${val}`);
    } else if (cmd.startsWith('ADD')) {
      const [, a, b, c] = cmd.match(/ADD (\d+) (\d+) -> (\d+)/);
      memory[+c] = memory[+a] + memory[+b];
      logToConsole(`ADD ${a} + ${b} -> ${c}`);
    } else if (cmd.startsWith('PRINT ')) {
      const text = cmd.match(/PRINT ['"](.+)['"]/)[1];
      logToConsole('üñ® ' + text);
    } else if (cmd.startsWith('PRINTMEM')) {
      const [, index] = cmd.match(/PRINTMEM (\d+)/);
      const v = memory[+index];
      logToConsole('üß† MEM[' + index + '] = ' + v + ' ‚Üí ' + String.fromCharCode(v));
    } else if (cmd === 'PRINTALL') {
      printText();
    } else if (cmd.startsWith('IF')) {
      const m = cmd.match(/IF MEMÓÄÅ(\d+)ÓÄÅ == (\d+) THEN PRINT ['"](.+)['"]/);
      if (m && memory[+m[1]] == +m[2]) {
        logToConsole('üßæ –£–º–æ–≤–∞ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è: ' + m[3]);
      }
    }
  });
  update();
}

document.getElementById('runButton').addEventListener('click', () => executeInstruction());
document.getElementById('autoRun').addEventListener('click', () => {
  if (!clockOn) {
    clockOn = true;
    document.getElementById('clockState').innerText = '‚è≥ –ü—Ä–∞—Ü—é—î...';
    clockInterval = setInterval(() => executeInstruction(), 1000);
  }
});
document.getElementById('stopRun').addEventListener('click', () => {
  clockOn = false;
  document.getElementById('clockState').innerText = '‚èπ –ó—É–ø–∏–Ω–µ–Ω–æ';
  clearInterval(clockInterval);
});

createStoreButtons();
update();
</script></body>
</html>
